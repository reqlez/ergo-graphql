"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.InputsCollection = void 0;
const errors_1 = require("../../errors");
const bigIntUtils_1 = require("../../utils/bigIntUtils");
const collection_1 = require("./collection");
class InputsCollection extends collection_1.Collection {
    constructor(boxes) {
        super();
        if (boxes) {
            this.add(boxes);
        }
    }
    add(boxOrBoxes) {
        if (!Array.isArray(boxOrBoxes)) {
            this._add(boxOrBoxes);
            return this;
        }
        for (const box of boxOrBoxes) {
            this._add(box);
        }
        return this;
    }
    _add(box) {
        if (this._items.some((item) => item.boxId === box.boxId)) {
            throw new errors_1.DuplicateInputError(box.boxId);
        }
        this._items.push(this._map(box));
    }
    _map(input) {
        return {
            ...input,
            value: (0, bigIntUtils_1.toBigInt)(input.value),
            assets: input.assets.map((asset) => {
                return { tokenId: asset.tokenId, amount: (0, bigIntUtils_1.toBigInt)(asset.amount) };
            })
        };
    }
    remove(boxIdOrIndex) {
        let index = -1;
        if (typeof boxIdOrIndex === "number") {
            if (this._isIndexOutOfBounds(boxIdOrIndex)) {
                throw new RangeError(`Index '${boxIdOrIndex}' is out of range.`);
            }
            index = boxIdOrIndex;
        }
        else {
            index = this._items.findIndex((box) => box.boxId === boxIdOrIndex);
            if (this._isIndexOutOfBounds(index)) {
                throw new errors_1.NotFoundError("The input you are trying to remove is not present in the inputs collection.");
            }
        }
        if (index > -1) {
            this._items.splice(index, 1);
        }
        return this;
    }
}
exports.InputsCollection = InputsCollection;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXRzQ29sbGVjdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9tb2RlbHMvY29sbGVjdGlvbnMvaW5wdXRzQ29sbGVjdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSx5Q0FBa0U7QUFFbEUseURBQW1EO0FBQ25ELDZDQUEwQztBQUUxQyxNQUFhLGdCQUFpQixTQUFRLHVCQUF1QjtJQUkzRCxZQUFZLEtBQW1DO1FBQzdDLEtBQUssRUFBRSxDQUFDO1FBRVIsSUFBSSxLQUFLLEVBQUU7WUFDVCxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQ2pCO0lBQ0gsQ0FBQztJQUtNLEdBQUcsQ0FBQyxVQUF1QztRQUNoRCxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsRUFBRTtZQUM5QixJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBRXRCLE9BQU8sSUFBSSxDQUFDO1NBQ2I7UUFFRCxLQUFLLE1BQU0sR0FBRyxJQUFJLFVBQVUsRUFBRTtZQUM1QixJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQ2hCO1FBRUQsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBRU8sSUFBSSxDQUFDLEdBQWdCO1FBQzNCLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLEtBQUssR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFO1lBQ3hELE1BQU0sSUFBSSw0QkFBbUIsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7U0FDMUM7UUFFRCxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDbkMsQ0FBQztJQUVPLElBQUksQ0FBQyxLQUFrQjtRQUM3QixPQUFPO1lBQ0wsR0FBRyxLQUFLO1lBQ1IsS0FBSyxFQUFFLElBQUEsc0JBQVEsRUFBQyxLQUFLLENBQUMsS0FBSyxDQUFDO1lBQzVCLE1BQU0sRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFO2dCQUNqQyxPQUFPLEVBQUUsT0FBTyxFQUFFLEtBQUssQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLElBQUEsc0JBQVEsRUFBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQztZQUNwRSxDQUFDLENBQUM7U0FDSCxDQUFDO0lBQ0osQ0FBQztJQUlNLE1BQU0sQ0FBQyxZQUE0QjtRQUN4QyxJQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQztRQUNmLElBQUksT0FBTyxZQUFZLEtBQUssUUFBUSxFQUFFO1lBQ3BDLElBQUksSUFBSSxDQUFDLG1CQUFtQixDQUFDLFlBQVksQ0FBQyxFQUFFO2dCQUMxQyxNQUFNLElBQUksVUFBVSxDQUFDLFVBQVUsWUFBWSxvQkFBb0IsQ0FBQyxDQUFDO2FBQ2xFO1lBRUQsS0FBSyxHQUFHLFlBQVksQ0FBQztTQUN0QjthQUFNO1lBQ0wsS0FBSyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsS0FBSyxLQUFLLFlBQVksQ0FBQyxDQUFDO1lBRW5FLElBQUksSUFBSSxDQUFDLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxFQUFFO2dCQUNuQyxNQUFNLElBQUksc0JBQWEsQ0FDckIsNkVBQTZFLENBQzlFLENBQUM7YUFDSDtTQUNGO1FBRUQsSUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDLEVBQUU7WUFDZCxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7U0FDOUI7UUFFRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7Q0FDRjtBQXpFRCw0Q0F5RUMifQ==