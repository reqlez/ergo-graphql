"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const mockBoxes_1 = require("../mocks/mockBoxes");
const bigIntUtils_1 = require("./bigIntUtils");
const boxUtils_1 = require("./boxUtils");
describe("Box sumByTokenId", () => {
    it("Should sum correctly", () => {
        const inputs = mockBoxes_1.regularBoxesMock.filter((input) => [
            "2555e34138d276905fe0bc19240bbeca10f388a71f7b4d2f65a7d0bfd23c846d",
            "467b6867c6726cc5484be3cbddbf55c30c0a71594a20c1ac28d35b5049632444",
            "2555e34138d276905fe0bc19240bbeca10f388a71f7b4d2f65a7d0bfd23c846d"
        ].includes(input.boxId));
        expect((0, boxUtils_1.sumByTokenId)(inputs, "0cd8c9f416e5b1ca9f986a7f10a84191dfb85941619e49e53c0dc30ebf83324b")).toBe(3819n);
    });
    it("Should return zero for empty arrays", () => {
        expect((0, boxUtils_1.sumByTokenId)([], "0cd8c9f416e5b1ca9f986a7f10a84191dfb85941619e49e53c0dc30ebf83324b")).toBe(0n);
    });
});
describe("Sum boxes", () => {
    it("Should sum all tokens and nanoErgs", () => {
        const boxes = mockBoxes_1.regularBoxesMock.filter((input) => [
            "e56847ed19b3dc6b72828fcfb992fdf7310828cf291221269b7ffc72fd66706e",
            "a2c9821f5c2df9c320f17136f043b33f7716713ab74c84d687885f9dd39d2c8a",
            "3e67b4be7012956aa369538b46d751a4ad0136138760553d5400a10153046e52",
            "2555e34138d276905fe0bc19240bbeca10f388a71f7b4d2f65a7d0bfd23c846d"
        ].includes(input.boxId));
        expect((0, boxUtils_1.sumBoxes)(boxes)).toEqual({
            nanoErgs: (0, bigIntUtils_1.sumBy)(boxes, (x) => x.value),
            tokens: [
                {
                    tokenId: "007fd64d1ee54d78dd269c8930a38286caa28d3f29d27cadcb796418ab15c283",
                    amount: 226652336n
                },
                {
                    tokenId: "0cd8c9f416e5b1ca9f986a7f10a84191dfb85941619e49e53c0dc30ebf83324b",
                    amount: 10n
                }
            ]
        });
    });
    it("Should sum if box doesn't contains tokens", () => {
        const boxes = mockBoxes_1.regularBoxesMock.filter((input) => [
            "e56847ed19b3dc6b72828fcfb992fdf7310828cf291221269b7ffc72fd66706e",
            "30cb07d93f16f5b052e9f56c1b5dfb83db9ccaeb467dde064933afc23beb6f5f"
        ].includes(input.boxId));
        expect((0, boxUtils_1.sumBoxes)(boxes)).toEqual({
            nanoErgs: (0, bigIntUtils_1.sumBy)(boxes, (x) => x.value),
            tokens: []
        });
    });
});
describe("Densely pack check - areRegistersDenselyPacked()", () => {
    it("Should pass for VALID registers packing", () => {
        expect((0, boxUtils_1.areRegistersDenselyPacked)({
            R4: "0580c0fc82aa02"
        })).toBeTruthy();
        expect((0, boxUtils_1.areRegistersDenselyPacked)({
            R4: "0580c0fc82aa02",
            R5: "07036b84756b351ee1c57fd8c302e66a1bb927e5d8b6e1a8e085935de3971f84ae17"
        })).toBeTruthy();
        expect((0, boxUtils_1.areRegistersDenselyPacked)({
            R4: "0580c0fc82aa02",
            R5: "0580c0fc82aa02",
            R6: "0580c0fc82aa02",
            R7: "0580c0fc82aa02",
            R8: "0580c0fc82aa02",
            R9: "0580c0fc82aa02"
        })).toBeTruthy();
    });
    it("Should fail for INVALID registers packing", () => {
        // R4 not included
        expect((0, boxUtils_1.areRegistersDenselyPacked)({
            R5: "0580c0fc82aa02"
        })).toBeFalsy();
        // R5 not included
        expect((0, boxUtils_1.areRegistersDenselyPacked)({
            R4: "0580c0fc82aa02",
            R6: "07036b84756b351ee1c57fd8c302e66a1bb927e5d8b6e1a8e085935de3971f84ae17"
        })).toBeFalsy();
        // R4, R5 and R6 not included
        expect((0, boxUtils_1.areRegistersDenselyPacked)({
            R7: "07036b84756b351ee1c57fd8c302e66a1bb927e5d8b6e1a8e085935de3971f84ae17"
        })).toBeFalsy();
        // R5, R6, R7 and R8 not included
        expect((0, boxUtils_1.areRegistersDenselyPacked)({
            R4: "0580c0fc82aa02",
            R9: "07036b84756b351ee1c57fd8c302e66a1bb927e5d8b6e1a8e085935de3971f84ae17"
        })).toBeFalsy();
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYm94VXRpbHMuc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy91dGlscy9ib3hVdGlscy5zcGVjLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsa0RBQXNEO0FBQ3RELCtDQUFzQztBQUN0Qyx5Q0FBK0U7QUFFL0UsUUFBUSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtJQUNoQyxFQUFFLENBQUMsc0JBQXNCLEVBQUUsR0FBRyxFQUFFO1FBQzlCLE1BQU0sTUFBTSxHQUFHLDRCQUFnQixDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQy9DO1lBQ0Usa0VBQWtFO1lBQ2xFLGtFQUFrRTtZQUNsRSxrRUFBa0U7U0FDbkUsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUN4QixDQUFDO1FBRUYsTUFBTSxDQUNKLElBQUEsdUJBQVksRUFBQyxNQUFNLEVBQUUsa0VBQWtFLENBQUMsQ0FDekYsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDaEIsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMscUNBQXFDLEVBQUUsR0FBRyxFQUFFO1FBQzdDLE1BQU0sQ0FDSixJQUFBLHVCQUFZLEVBQUMsRUFBRSxFQUFFLGtFQUFrRSxDQUFDLENBQ3JGLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ2IsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQztBQUVILFFBQVEsQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFO0lBQ3pCLEVBQUUsQ0FBQyxvQ0FBb0MsRUFBRSxHQUFHLEVBQUU7UUFDNUMsTUFBTSxLQUFLLEdBQUcsNEJBQWdCLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FDOUM7WUFDRSxrRUFBa0U7WUFDbEUsa0VBQWtFO1lBQ2xFLGtFQUFrRTtZQUNsRSxrRUFBa0U7U0FDbkUsQ0FBQyxRQUFRLENBQUMsS0FB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